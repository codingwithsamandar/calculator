
:root {
            --bg-body: #0a0a0b;
            --calc-surface: #141417;
            --display-bg: #0a0a0b;
            --text-main: #ffffff;
            --text-dim: #71717a;
            --btn-bg: #1d1d21;
            --btn-hover: #27272a;
            --btn-active: #2e2e33;
            --accent: #f59e0b;
            --accent-grad: linear-gradient(135deg, #f59e0b 0%, #ea580c 100%);
            --panel-bg: rgba(20, 20, 23, 0.98);
            --danger: #f43f5e;
            --color-btn: white;
        }

        [data-theme="emerald"] {
            --bg-body: #022c22; --calc-surface: #064e3b; --display-bg: #022c22;
            --text-main: #ecfdf5; --text-dim: #a7f3d0; --btn-bg: #065f46; 
            --btn-hover: #047857; --accent: #10b981;--color-btn: white;
            --accent-grad: linear-gradient(135deg, #10b981 0%, #34d399 100%);
        }
        
        [data-theme="purple"] {
            --bg-body: #1e1b4b; --calc-surface: #312e81; --display-bg: #1e1b4b;
            --text-main: #f5f3ff; --text-dim: #a5b4fc; --btn-bg: #3730a3;
            --btn-hover: #4338ca; --accent: #818cf8;--color-btn: white;
            --accent-grad: linear-gradient(135deg, #818cf8 0%, #c084fc 100%);
        }
        
        [data-theme="mocha"] {
            --bg-body: #1c1917; --calc-surface: #292524; --display-bg: #1c1917;
            --text-main: #fafaf9; --text-dim: #a8a29e; --btn-bg: #44403c;
            --btn-hover: #57534e; --accent: #d6d3d1;--color-btn: white;
            --accent-grad: linear-gradient(135deg, #a8a29e 0%, #d6d3d1 100%);
        }
        
        [data-theme="rose"] {
            --bg-body: #2d161a; --calc-surface: #3d1d23; --display-bg: #2d161a;
            --text-main: #fff1f2; --text-dim: #fda4af; --btn-bg: #4c242c;
            --btn-hover: #5e2d37; --accent: #fb7185;--color-btn: white;
            --accent-grad: linear-gradient(135deg, #fb7185 0%, #e11d48 100%);
        }
        
        [data-theme="nordic"] {
            --bg-body: #f4f4f5; --calc-surface: #ffffff; --display-bg: #f4f4f5;
            --text-main: #09090b; --text-dim: #71717a; --btn-bg: #f1f1f4; --color-btn: white;
            --btn-hover: #e4e4e7; --accent: #18181b;
            --accent-grad: linear-gradient(135deg, #18181b 0%, #52525b 100%);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Montserrat', sans-serif; -webkit-tap-highlight-color: transparent; }
        
        body {
            background-color: var(--bg-body);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            min-height: 100dvh; padding: 15px; transition: background-color 0.4s ease;
            overflow: hidden; /* Evita cualquier scroll accidental en el body */
        }
        
        .calc-wrapper {
            position: relative; width: 100%; max-width: 350px; 
            background-color: var(--calc-surface); padding: 24px; 
            border-radius: 42px; border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 40px 100px rgba(0, 0, 0, 0.6); overflow: hidden;
        }
        
        .calc-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding: 0 5px; }
        .brand-name { color: var(--text-dim); font-size: 0.7rem; letter-spacing: 2px; font-weight: 700; }
        .settings-toggle { background: none; border: none; color: var(--text-dim); cursor: pointer; display: flex; transition: color 0.2s; }
        .settings-toggle:hover { color: var(--accent); }
        
        /* PANEL DE TEMAS SIN SCROLL */
        .theme-panel {
            position: absolute; inset: 0;
            background: var(--panel-bg); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            z-index: 50; padding: 30px 24px;
            display: flex; flex-direction: column;
            transform: translateX(-100%); transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden; /* Crucial para evitar la barra inferior */
        }
        .theme-panel.active { transform: translateX(0); }
        
        .panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
        .panel-header h3 { color: var(--text-main); font-size: 1.2rem; font-weight: 700; }
        
        .close-panel { 
            background: var(--btn-bg); border: none; color: var(--text-main); 
            width: 36px; height: 36px; border-radius: 12px; cursor: pointer;
            display: flex; align-items: center; justify-content: center; font-size: 1.2rem;
        }
        
        .theme-list { 
            display: flex; flex-direction: column; gap: 10px; 
            overflow-y: auto; overflow-x: hidden; /* Solo scroll vertical si fuera necesario */
            padding-right: 5px; 
        }
        
        .theme-option {
            background: var(--btn-bg); padding: 15px 20px; border-radius: 18px;
            display: flex; align-items: center; justify-content: space-between;
            cursor: pointer; transition: all 0.2s ease; border: 1px solid rgba(255,255,255,0.03);
            color: var(--text-main); font-weight: 500; font-size: 0.95rem;
            width: 100%;
        }
        .theme-option:hover { 
            background: var(--btn-hover); 
            padding-left: 25px; /* Efecto de desplazamiento interno en lugar de translateX */
        }
        .color-dot { width: 14px; height: 14px; border-radius: 50%; }
        
        /* DISPLAY */
        .display {
            width: 100%; min-height: 110px; display: flex; flex-direction: column;
            justify-content: flex-end; align-items: flex-end; padding: 15px;
            margin-bottom: 20px; background: var(--display-bg); border-radius: 28px;
        }
        #history { color: var(--text-dim); font-size: 0.95rem; min-height: 1.2rem; margin-bottom: 5px; }
        #result { color: var(--text-main); font-size: 3.2rem; font-weight: 700; letter-spacing: -1.5px; line-height: 1; }
        
        /* KEYPAD */
        .keypad { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; }
        button { 
            border: none; background-color: var(--btn-bg); color: var(--text-main); 
            height: 62px; border-radius: 20px; font-size: 1.4rem; font-weight: 500; 
            cursor: pointer; transition: all 0.1s; display: flex; align-items: center; justify-content: center;
        }
        button:active { transform: scale(0.92); }
        
        .op { color: var(--accent); font-weight: 600; font-size: 1.6rem; }
        .eq { background: var(--accent-grad); color: white; grid-column: span 2; font-weight: 700; }
        .ac { color: var(--danger); grid-column: span 2; font-weight: 600; background: rgba(244, 63, 94, 0.08); }
        .del { color: var(--danger); font-size: 0.9rem; font-weight: 600; }
        
        footer { margin-top: 25px; text-align: center; }
        .signature { color: var(--text-dim); font-size: 0.75rem; }
        .signature strong { color: var(--text-main); }
        .changelog-link { display: block; margin-top: 8px; color: var(--accent); text-decoration: none; font-size: 0.7rem; font-weight: 600; }
        
        /* MODAL */
        .modal-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.8); backdrop-filter: blur(5px);
            display: none; justify-content: center; align-items: center; z-index: 100; padding: 20px;
        }
        .modal-overlay.active { display: flex; }
        .modal-content { background: var(--calc-surface); width: 100%; max-width: 320px; padding: 30px; border-radius: 35px; border: 1px solid rgba(255,255,255,0.1); }
        
        @media (max-height: 680px) {
            .calc-wrapper { padding: 18px; }
            button { height: 52px; border-radius: 16px; font-size: 1.2rem; }
            .display { min-height: 90px; }
            #result { font-size: 2.6rem; }
        }
        
        .calculator_colors {
            position: absolute;
    display: flex;
    flex-direction: column;
    margin-top: -10px;
    margin-left: 500px;
    gap: 20px;
}
.calculator_colors button{
    padding: 20px;
}
.calculator_colors button:nth-child(1){
    background-color: #022c22;
    color: var(--color-btn);
}
.calculator_colors button:last-child{
    background-color: white;
    color: var(--color-btn);
}
.calculator_colors button:nth-child(2){
    background-color: #1e1b4b;
    color: var(--color-btn);
}
.calculator_colors button:nth-child(3){
    background-color: #1c1917;
    color: var(--color-btn);
}
.calculator_colors button:nth-child(4){
    background-color: #2d161a;
    color: var(--color-btn);
}
.calculator_colors button:nth-child(5){
    background-color:white;
    color: black;
}